<form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-4">

  <!-- Mensajes globales -->
  @if (successMessage()) {
    <div class="rounded-md bg-emerald-50 border border-emerald-200 px-3 py-2 text-sm text-emerald-700 mb-2">
      {{ successMessage() }}
    </div>
  }

  @if (errorMessage()) {
    <div class="rounded-md bg-red-50 border border-red-200 px-3 py-2 text-sm text-red-700 mb-2">
      {{ errorMessage() }}
    </div>
  }

  <!-- Nombre -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
    <div class="space-y-1">
      <label
        for="firstName"
        class="block text-sm font-medium text-slate-700"
      >
        Nombre
      </label>
      <input
        id="firstName"
        type="text"
        formControlName="firstName"
        class="w-full px-3 py-2 rounded-md border text-sm outline-none
               border-slate-300 focus:ring-2 focus:ring-brand-500 focus:border-brand-500
               placeholder:text-slate-400"
        placeholder="Nombre"
      />
      @if (firstName?.touched && firstName?.invalid) {
        <p class="text-xs text-red-600 mt-1">
          @if (firstName?.errors?.['required']) {
            El nombre es obligatorio.
          } @else if (firstName?.errors?.['minlength']) {
            El nombre es muy corto.
          }
        </p>
      }
    </div>

    <!-- Apellido -->
    <div class="space-y-1">
      <label
        for="lastName"
        class="block text-sm font-medium text-slate-700"
      >
        Apellidos
      </label>
      <input
        id="lastName"
        type="text"
        formControlName="lastName"
        class="w-full px-3 py-2 rounded-md border text-sm outline-none
               border-slate-300 focus:ring-2 focus:ring-brand-500 focus:border-brand-500
               placeholder:text-slate-400"
        placeholder="Apellidos"
      />
      @if (lastName?.touched && lastName?.invalid) {
        <p class="text-xs text-red-600 mt-1">
          @if (lastName?.errors?.['required']) {
            Los apellidos son obligatorios.
          } @else if (lastName?.errors?.['minlength']) {
            Los apellidos son muy cortos.
          }
        </p>
      }
    </div>
  </div>

  <!-- Email -->
  <div class="space-y-1">
    <label
      for="email"
      class="block text-sm font-medium text-slate-700"
    >
      Correo electrónico
    </label>
    <input
      id="email"
      type="email"
      formControlName="email"
      class="w-full px-3 py-2 rounded-md border text-sm outline-none
             border-slate-300 focus:ring-2 focus:ring-brand-500 focus:border-brand-500
             placeholder:text-slate-400"
      placeholder="tucorreo@ejemplo.com"
    />
    @if (email?.touched && email?.invalid) {
      <p class="text-xs text-red-600 mt-1">
        @if (email?.errors?.['required']) {
          El correo es obligatorio.
        } @else if (email?.errors?.['email']) {
          Ingresa un correo válido.
        }
      </p>
    }
  </div>

  <!-- Password -->
  <div class="space-y-1">
    <label
      for="password"
      class="block text-sm font-medium text-slate-700"
    >
      Contraseña
    </label>
    <input
      id="password"
      type="password"
      formControlName="password"
      class="w-full px-3 py-2 rounded-md border text-sm outline-none
             border-slate-300 focus:ring-2 focus:ring-brand-500 focus:border-brand-500
             placeholder:text-slate-400"
      placeholder="Mínimo 6 caracteres"
    />
    @if (password?.touched && password?.invalid) {
      <p class="text-xs text-red-600 mt-1">
        @if (password?.errors?.['required']) {
          La contraseña es obligatoria.
        } @else if (password?.errors?.['minlength']) {
          La contraseña debe tener al menos 6 caracteres.
        }
      </p>
    }
  </div>

  <!-- Botón submit -->
  <button
    type="submit"
    [disabled]="isSubmitting() || form.invalid"
    class="w-full flex items-center justify-center gap-2 mt-2
           px-4 py-2 rounded-md text-sm font-medium
           text-white bg-brand-600 hover:bg-brand-500
           disabled:opacity-60 disabled:cursor-not-allowed
           transition-colors"
  >
    @if (!isSubmitting()) {
      <span>Crear cuenta</span>
    } @else {
      <span class="flex items-center gap-2">
        <span
          class="h-4 w-4 border-2 border-white/50 border-t-transparent rounded-full animate-spin"
        ></span>
        Registrando...
      </span>
    }
  </button>

  <!-- Texto secundario -->
  <p class="mt-2 text-xs text-center text-slate-500">
    ¿Ya tienes cuenta?
    <a routerLink="/auth/login" class="text-brand-600 hover:underline">
      Inicia sesión aquí
    </a>
  </p>
</form>
